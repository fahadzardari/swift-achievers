---
import Heading from "../common/Heading.astro";
import WhyUsTag from "./WhyUsTag.astro";
import ChatIcon from "../../assets/home/chat.png";
import CallIcon from "../../assets/home/call.png";
import Image from "astro/components/Image.astro";
import Tag2 from "../../assets/icons/tag2.png";
import Tag3 from "../../assets/icons/tag3.png";
import Tag4 from "../../assets/icons/tag4.png";
import Tag5 from "../../assets/icons/tag5.png";
import Tag6 from "../../assets/icons/tag6.png";
import Tag7 from "../../assets/icons/tag7.png";
import Tag8 from "../../assets/icons/tag8.png";
---

<!-- Single section with SVG background -->
<section
  class="whyus-gradient-background relative flex min-h-screen flex-col justify-between overflow-hidden py-8 lg:pt-20"
  data-section-id={Math.random().toString(36).substr(2, 9)}
>
  <div class="absolute inset-0 -z-10 h-full w-full">
    <svg
      width="100%"
      height="100%"
      viewBox="0 0 1920 871"
      preserveAspectRatio="none"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      class="h-full w-full"
    >
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M1920 20C1920 8.95431 1911.05 0 1900 0H20C8.95431 0 0 8.9543 0 20V692C0 703.046 8.9543 712 20 712H280C291.046 712 300 720.954 300 732V843C300 858.464 312.536 871 328 871H1592C1607.46 871 1620 858.464 1620 843V732C1620 720.954 1628.95 712 1640 712H1900C1911.05 712 1920 703.046 1920 692V20Z"
        fill="url(#paint0_linear_38_3017)"></path>
      <defs>
        <linearGradient
          id="paint0_linear_38_3017"
          x1="300"
          y1="760.5"
          x2="1620"
          y2="760.5"
          gradientUnits="userSpaceOnUse"
        >
          <stop stop-color="#FD34FC"></stop>
          <stop offset="1" stop-color="#3135F6"></stop>
        </linearGradient>
      </defs>
    </svg>
  </div>
  <!-- Main content area -->
  <div class="upper-content container lg:pb-10">
    <Heading id="why-us-heading" title="Why Swyft Achievers?" />
    <h3
      class="why-us-subtitle 3xl:text-[26px] mt-4 text-[18px] text-white lg:text-[20px] xl:text-[22px] 2xl:text-[24px]"
    >
      Swyft Achievers Unlocks the Potential of a Winning E-Commerce Growth
      Strategy!
    </h3>
    <p
      class="why-us-description mt-4 text-xs text-white lg:text-sm 2xl:text-base"
    >
      Our Amazon Marketing Agency combines intelligent strategies with profit
      opportunities and new product solutions for brands in all niches. Our
      operational expertise has given us a creative, hands-on approach to
      assisting brands in reaching, expanding, and leading the e-commerce
      ecosystem.
    </p>
    <div
      class="why-us-tags item-center mx-auto mt-20 mb-4 grid grid-cols-1 gap-x-4 gap-y-6 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"
    >
      <WhyUsTag
        id="why-us-tag-1"
        title="Amazon SEO"
        description="To grow your Amazon store by increasing product visibility and attracting more customers."
      />
      <WhyUsTag
        id="why-us-tag-2"
        title="Store Management"
        description="To effectively monitor, source, manage, and oversee inventory."
        image={Tag2}
      />
      <WhyUsTag
        id="why-us-tag-3"
        title="Optimized Content"
        description="To enhance product listings and improve rankings on Amazon."
        image={Tag3}
      />
      <WhyUsTag
        id="why-us-tag-4"
        title="Support"
        description="For prompt, customer-focused support in managing Amazon advertising."
        image={Tag4}
      />
      <WhyUsTag
        id="why-us-tag-5"
        title="Amazon Advertising"
        description="To boost sales through targeted and strategic Amazon advertising."
        image={Tag5}
      />
      <WhyUsTag
        id="why-us-tag-6"
        title="Amazon Sales Boost"
        description="To improve product listings and enhance rankings on Amazon."
        image={Tag6}
      />
      <WhyUsTag
        id="why-us-tag-7"
        title="Price & Product Comparison"
        description="To help your company identify the best products and pricing opportunities."
        image={Tag7}
      />
      <!-- <WhyUsTag
        id="why-us-tag-8"
        title="EBC/A+ Content"
        description="For responsive and customer-centric support help for advertising Amazon"
        image={Tag8}
      /> -->
    </div>
  </div>

  <!-- Bottom CTA area aligned with the narrower part of SVG -->
  <div
    class="bottom-content 3xl:max-w-[1420px] mx-auto max-w-[400px] px-2 sm:max-w-[600px] lg:max-w-[680px] lg:px-0 xl:max-w-[850px] 2xl:max-w-[1000px]"
  >
    <div class="xl:py-8">
      <div
        class="flex flex-col items-center justify-between gap-x-24 gap-y-6 md:flex-row"
      >
        <div class="3xl:max-w-[60%] flex flex-col gap-4 lg:max-w-3/4">
          <h1
            id="why-us-secondary-heading"
            class="3xl:text-[56px] text-3xl leading-[1.2] font-semibold text-white md:text-4xl xl:text-5xl"
          >
            Take advantage of the expanding e-commerce ecosystem.
          </h1>
          <p
            class="why-us-cta-subtitle 3xl:text-xl text-xs font-semibold text-white md:text-sm lg:text-base xl:text-lg"
          >
            Connect with our senior consultants!
          </p>
        </div>
        <div class="why-us-buttons flex w-fit flex-col gap-6">
          <button
            class="crusor-pointer open-chat-widget why-us-call-btn 3xl:text-xl flex items-center justify-center gap-2 rounded-full bg-white px-5 py-1 text-left text-xs font-semibold whitespace-nowrap text-[#120136] md:text-sm xl:text-base"
          >
            <Image src={CallIcon} alt="Call Icon" class="h-4 w-4" />
            <span>Call Now</span>
          </button>
          <button
            class="open-contact-modal why-us-chat-btn 3xl:text-xl flex cursor-pointer items-center justify-center gap-2 rounded-full bg-white px-5 py-1 text-left text-xs font-semibold whitespace-nowrap text-[#120136] md:text-sm xl:text-base"
          >
            <Image src={ChatIcon} alt="Chat Icon" class="h-4 w-4" />
            <span>Get a Quote</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  .whyus-gradient-background {
    background: linear-gradient(
      90deg,
      var(--color-gradient-start),
      var(--color-gradient-end)
    );
  }

  @media screen and (min-width: 1024px) {
    .whyus-gradient-background {
      background: transparent;
    }
  }
</style>

<script>
  import gsap from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";
  import SplitType from "split-type";

  document.addEventListener("DOMContentLoaded", () => {
    // Register ScrollTrigger plugin
    gsap.registerPlugin(ScrollTrigger);

    // Initialize SplitType for text elements
    const whyUsHeading = new SplitType("#why-us-heading h2", {
      types: "words,chars",
    });

    const whyUsSubtitle = new SplitType(".why-us-subtitle", {
      types: "lines",
    });

    const whyUsDescription = new SplitType(".why-us-description", {
      types: "lines",
    });

    const whyUsSecondaryHeading = new SplitType("#why-us-secondary-heading", {
      types: "words,chars",
    });

    const whyUsCtaSubtitle = new SplitType(".why-us-cta-subtitle", {
      types: "words",
    });

    // Create timeline for heading section
    const whyUsTl = gsap.timeline({
      scrollTrigger: {
        trigger: ".whyus-gradient-background",
        start: "top 85%",
        end: "top 40%",
        scrub: 0.8,
        toggleActions: "play none none reverse",
      },
    });

    // Animate the main heading with staggered characters
    whyUsTl.fromTo(
      whyUsHeading.chars,
      {
        opacity: 0,
        y: 30,
      },
      {
        opacity: 1,
        y: 0,
        stagger: 0.02,
        duration: 0.4,
        ease: "power2.out",
      },
      0,
    );

    // Animate the subtitle lines
    whyUsTl.fromTo(
      whyUsSubtitle.lines,
      {
        opacity: 0,
        y: 20,
      },
      {
        opacity: 1,
        y: 0,
        stagger: 0.1,
        duration: 0.5,
      },
      0.3,
    );

    // Animate the description lines
    whyUsTl.fromTo(
      whyUsDescription.lines,
      {
        opacity: 0,
        y: 15,
      },
      {
        opacity: 1,
        y: 0,
        stagger: 0.08,
        duration: 0.4,
      },
      0.5,
    );

    // Create timeline for the tags
    const tagsTl = gsap.timeline({
      scrollTrigger: {
        trigger: ".why-us-tags",
        start: "top 75%", // Adjusted to start animation earlier
        end: "center 40%", // Adjusted to give more time to complete the animation
        scrub: 0.8,
        toggleActions: "play none none reverse",
      },
    });

    // Make sure to target all tags even if some don't have proper IDs
    const allTags = document.querySelectorAll(".why-us-tags > div");

    // More visually impressive animation with rotation and better staggering
    tagsTl.fromTo(
      allTags,
      {
        opacity: 0,
        y: 60,
        scale: 0.85,
        rotationX: 10, // Slight 3D rotation for more dimension
      },
      {
        opacity: 1,
        y: 0,
        scale: 1,
        rotationX: 0,
        stagger: {
          each: 0.12,
          from: "start", // Start from the first tag
          grid: "auto", // Works with grid layouts
        },
        duration: 0.6,
        ease: "back.out(1.2)", // More bouncy effect
      },
      0,
    );

    // Enhanced hover effects for tags
    allTags.forEach((tag) => {
      tag.addEventListener("mouseenter", () => {
        gsap.to(tag, {
          y: -10,
          scale: 1.05,
          boxShadow: "0 10px 25px rgba(0,0,0,0.15)", // Add shadow on hover
          duration: 0.35,
          ease: "power2.out",
        });
      });

      tag.addEventListener("mouseleave", () => {
        gsap.to(tag, {
          y: 0,
          scale: 1,
          boxShadow: "0 0px 0px rgba(0,0,0,0)",
          duration: 0.4,
          ease: "power2.in",
        });
      });
    });

    // Create timeline for bottom content
    const bottomTl = gsap.timeline({
      scrollTrigger: {
        trigger: ".bottom-content",
        start: "top 85%",
        end: "top 65%",
        scrub: 0.8,
        toggleActions: "play none none reverse",
      },
    });

    // Animate the secondary heading
    bottomTl.fromTo(
      whyUsSecondaryHeading.chars,
      {
        opacity: 0,
        y: 25,
      },
      {
        opacity: 1,
        y: 0,
        stagger: 0.015,
        duration: 0.4,
        ease: "power2.out",
      },
      0,
    );

    // Animate the CTA subtitle
    bottomTl.fromTo(
      whyUsCtaSubtitle.words,
      {
        opacity: 0,
        y: 15,
      },
      {
        opacity: 1,
        y: 0,
        stagger: 0.05,
        duration: 0.4,
      },
      0.3,
    );

    // Animate buttons
    bottomTl.fromTo(
      [".why-us-call-btn", ".why-us-chat-btn"],
      {
        opacity: 0,
        x: 30,
      },
      {
        opacity: 1,
        x: 0,
        stagger: 0.15,
        duration: 0.6,
        ease: "power2.out",
      },
      0.4,
    );

    // Add hover effects for tags
    tags.forEach((tag) => {
      tag.addEventListener("mouseenter", () => {
        gsap.to(tag, {
          y: -8,
          scale: 1.03,
          duration: 0.3,
          ease: "power2.out",
        });
      });

      tag.addEventListener("mouseleave", () => {
        gsap.to(tag, {
          y: 0,
          scale: 1,
          duration: 0.3,
          ease: "power2.in",
        });
      });
    });

    // Add click animation for buttons
    const buttons = document.querySelectorAll(
      ".why-us-call-btn, .why-us-chat-btn",
    );
    buttons.forEach((button) => {
      button.addEventListener("click", () => {
        gsap.to(button, {
          scale: 0.95,
          duration: 0.1,
          onComplete: () => {
            gsap.to(button, {
              scale: 1,
              duration: 0.1,
            });
          },
        });
      });
    });
  });
</script>
