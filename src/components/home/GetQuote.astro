---
import Heading from "../common/Heading.astro";
import ChatIcon from "../../assets/home/chat.png";
import CallIcon from "../../assets/home/call.png";
import Image from "astro/components/Image.astro";
---

<section id="get-quote-section" class="container mx-auto my-12">
  <div
    id="get-quote-bg"
    class="bg-gradient flex flex-col items-center justify-between gap-x-12 gap-y-6 rounded-2xl px-12 py-10 md:flex-row"
  >
    <div class="flex flex-col gap-4 lg:max-w-[70%]">
      <Heading id="get-quote-heading" title="Got Questions? Or Need a Quote?" />
      <p
        id="get-quote-paragraph"
        class="3xl:text-xl text-xs font-semibold text-white md:text-sm lg:text-base xl:text-lg"
      >
        We always appreciate your thoughts. So feel free to raise any concern
        with us, whether that be a query not addressed in the FAQs or curiosity
        to know more about us. We’re here for you, and we’ll answer in a jiffy!
      </p>
    </div>
    <div id="get-quote-buttons" class="flex flex-col gap-6">
      <button
        id="get-quote-call"
        class="open-chat-widget 3xl:text-xl flex cursor-pointer items-center justify-center gap-2 rounded-full bg-white px-5 py-1 text-left text-xs font-semibold text-[#120136] md:text-sm xl:text-lg"
      >
        <Image src={CallIcon} alt="Chat Icon" class="h-4 w-4" loading={"lazy"} />
        <span>Call Now</span>
      </button>
      <button
        id="get-quote-chat"
        class="open-contact-modal 3xl:text-xl flex cursor-pointer items-center justify-center gap-2 rounded-full bg-white px-5 py-1 text-left text-xs font-semibold text-[#120136] md:text-sm xl:text-lg"
      >
        <Image src={ChatIcon} alt="Chat Icon" class="h-4 w-4" loading={"lazy"} />
        <span>Get a Quote</span>
      </button>
    </div>
  </div>
</section>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/all";

  gsap.registerPlugin(ScrollTrigger);

  document.addEventListener("DOMContentLoaded", () => {
    // Create timeline for sequential animations
    const mainTl = gsap.timeline({
      scrollTrigger: {
        trigger: "#get-quote-section",
        start: "top 85%",
        toggleActions: "play none none none",
        once: true,
      },
    });

    // Heading animation
    mainTl.fromTo(
      "#get-quote-heading",
     
      {
        opacity: 1,
        y: 0,
        clipPath: "polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)",
        duration: 0.7,
        ease: "power2.out",
      },
    );

    // Paragraph animation
    mainTl.fromTo(
      "#get-quote-paragraph",
      { opacity: 0, y: 15 },
      {
        opacity: 1,
        y: 0,
        duration: 0.6,
        ease: "power2.out",
      },
      "-=0.3", // Overlap with previous animation
    );

    // Buttons animation
    mainTl.fromTo(
      "#get-quote-call",
      { opacity: 0, scale: 0.9, y: 20 },
      {
        opacity: 1,
        scale: 1,
        y: 0,
        duration: 0.5,
        ease: "back.out(1.2)",
      },
      "-=0.2",
    );

    mainTl.fromTo(
      "#get-quote-chat",
      { opacity: 0, scale: 0.9, y: 20 },
      {
        opacity: 1,
        scale: 1,
        y: 0,
        duration: 0.5,
        ease: "back.out(1.2)",
      },
      "-=0.3",
    );

    // Optional: Add hover animations for buttons
    ["#get-quote-call", "#get-quote-chat"].forEach((buttonId) => {
      const button = document.querySelector(buttonId);
      if (!button) return;

      button.addEventListener("mouseenter", () => {
        gsap.to(button, {
          scale: 1.05,
          duration: 0.3,
          ease: "power1.out",
        });
      });

      button.addEventListener("mouseleave", () => {
        gsap.to(button, {
          scale: 1,
          duration: 0.3,
          ease: "power1.out",
        });
      });
    });

    // Subtle background animation (one-time only)
    gsap.fromTo(
      "#get-quote-bg",
      { backgroundPosition: "0% 0%" },
      {
        backgroundPosition: "100% 100%",
        duration: 4,
        ease: "power1.inOut",
        scrollTrigger: {
          trigger: "#get-quote-section",
          start: "top 85%",
          toggleActions: "play none none none",
          once: true,
        },
      },
    );
  });
</script>
